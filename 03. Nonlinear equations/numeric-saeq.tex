\documentclass[12pt,a4paper]{article}
\usepackage[warn] {mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[top=2cm, bottom=2cm, marginparwidth=0pt, left=3cm, right=1.5cm]{geometry}
\usepackage{wasysym}
\usepackage{listings}

\lstloadlanguages{Octave}
\lstset{extendedchars=true, escapechar=|, frame = tb, }

\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}[theorem]{Лемма}
\newtheorem{proposition}[theorem]{Утверждение}
\newtheorem{corollary}[theorem]{Следствие}

\newenvironment{proof}[1][Доказательство.]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{definition}[1][Определение.]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{example}[1][Пример.]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{remark}[1][Замечание.]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcounter{problem}[subsection]

\newenvironment{problem}[1][Задача \arabic{section}.\arabic{subsection}.\arabic{problem}.]
{\addtocounter{problem}{1}
\begin{trivlist}
	\item[\hskip \labelsep {\bfseries #1}]}
{\end{trivlist}}

\newenvironment{code}[1][Код.]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}

%\providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\abs}[1]{\left|#1\right|}
\providecommand{\norm}[1]{\left\lVert#1\right\rVert}


\begin{document}

\setcounter{section}{2}

\section{Численные методы решения систем нелинейных \\ уравнений}
\subsection{Метод простой итерации}

Рассматривается система уравнений
\[
	f(x) = 0, \quad f:\mathbb{R}^n \to \mathbb{R}^m.
\]
Предположим, что эту систему можно записать в виде $x = g(x)$ и выбран некоторый вектор 
$x^0$, лежащий в области определения функции $g(x)$.

Последовательное применение функции $g$ к точке $x^0$, ее образу $g(x^0)$, образу образа
 $g(g(x^0))$ и т.д., называется итерированием функции $g$ в этой точке или --- процессом итерации:
\[
	x^{k+1} = g(x^k), \quad k \in \mathbb{N}_0.
\]
Для решения уравнений важна именно последовательность точек $\left\{x^k\right\}$, однако
сначала остановимся на таком понятии, как неподвижная точка. Для простоты ограничимся
случаем скалярного уравнения, т.е. $n = m = 1$.
\begin{definition}
	Неподвижной точкой отображения $g : \mathbb{R} \to \mathbb{R}$ называется число 
	$P$ такое, что $g(P) = P$.
\end{definition}
\begin{theorem}
	Пусть $g : \mathbb{R} \to \mathbb{R}$ --- непрерывная функция. Если $\exists \lim\limits_{k \to \infty}{x^k} = P$,
	то $P$ --- неподвижная точка функции $g$.
\end{theorem}

Таким образом, итерирование дает возможность  находить корни уравнений. Вопрос лишь в том,
каковы условия сходимости последовательности $\left\{x^k\right\}$, т.е. к какому классу уравнений
применим метод итераций?

Ответ на этот вопрос основан на такой фундаментальной теореме, как теорема Брауэра о неподвижной точке.
Она допускает многие обобщения, но основная (первоначальная) идея формулируется следующим образом:
\begin{theorem}(Брауэра)
	Любое непрерывное отображение (не обязательно биекция) замкнутого шара в себя в
	конечномерном евклидовом пространстве имеет неподвижную точку.
\end{theorem}

С этой теоремой непосредственно связан интересный математический зверек --- сферический ёж.

\begin{theorem}(о причесывании ежа)
	Не существует непрерывного касательного векторного поля на сфере, которое нигде бы не обращалось в нуль.
\end{theorem}
Этот математический факт имеет важное значение в метеорологии --- он обосновывает существование циклонов в атмосфере.

Вернемся, однако, к итерациям. Следующие две теоремы определяют условия сходимости процесса итераций.
\begin{theorem}
	Пусть $g \in C_{\left[a, b\right]}$.
	\begin{enumerate}
		\item Если $g$ отображает отрезок $\left[a, b\right]$ в себя, то $g$ имеет неподвижную точку на $\left[a, b\right]$.
		\item Если существует производная $g'$ на интервале $\left(a, b\right)$ и она ограничена по модулю
			константой $K < 1$ на этом интервале, то $g$ имеет единственную неподвижную точку на отрезке $\left[a, b\right]$.
	\end{enumerate}
\end{theorem}
\begin{example}
	Имеет ли функция $\cos{x}$ неподвижную точку на отрезке $\left[0, 1\right]$? Одну?
\end{example}
\begin{theorem}(о сходимости итераций)
	Пусть $g$ --- непрерывно дифференцируемое отображение отрезка $\left[a, b\right]$ в себя и точка 
	$x^0$ взята из интервала $\left(a, b\right)$.
	\begin{enumerate}
		\item Если существует константа $K$ такая, что $ \abs{g'(x)} \leq K < 1\quad \forall x \in \left[a, b\right]$, то
		итерационный процесс $x^{k+1} = g(x^k)$ сходится к единственной неподвижной точке $P \in \left[a, b\right]$.
		Говорят, что неподвижная точка $P$ является притягивающей (аттрактором).
		\item Если $\forall x \in \left[a, b\right] \quad g'(x) > 1$, то итерационный процесс не сходится к $P$. В этом случае
		неподвижная точка называется отталкивающей.
	\end{enumerate}
\end{theorem}
\begin{corollary}
	$\abs{P - x^k} \leq K^k\abs{P - x^0}$.
\end{corollary}
Таким образом, на скорость сходимости итерационного процесса влияют как свойства функции $g$, так и точность
начального приближения.
\begin{remark}
	Случай $\abs{g'(x)} \equiv 1$ теорема оставляет без внимания. Что можно сказать в этом случае?
\end{remark}
\begin{example}
	Исследовать сходимость итерационного процесса, где $g(x) = 2\left(x-1\right)^{\frac{1}{2}}, x \geq 1, P = 2$?
\end{example}
\begin{remark}
	Можно использовать более простой критерий сходимости: $\abs{g'(P)} > 1$ или, соответственно, $\abs{g'(P)} < 1$.
\end{remark}
Графически итерационный процесс удобно изображать в пространстве $\left(x, g(x)\right)$.

\begin{example}
	Решить уравнение $x^2 = a$.
	\begin{trivlist}
		\item {\bf I способ.} $\displaystyle x^2 = a \Leftrightarrow x = \frac{a}{x}, x \neq 0$. Строим итерационный
		процесс по формуле
		\[
			x^{n+1} = \frac{a}{x^n} = g_I(x^n).
		\]
		Пусть теперь $x^0$ --- некоторое начальное приближение, $x^0 \neq \sqrt{a}$.
		\[
			\abs{x^{n+1} - \sqrt{a}} = \abs{\frac{a}{x^n} - \sqrt{a}} = \abs{\frac{a - \sqrt{a}x^n}{x^n}} = 
			\frac{\sqrt{a}\abs{\sqrt{a} - x^n}}{\abs{x^n}} = \frac{\sqrt{a}}{\abs{x^n}}\abs{\sqrt{a} - x^n}.
		\]
		Итерации расходятся при любом начальном приближении.
		\item {\bf II способ.} $\displaystyle x^2 = a \Leftrightarrow x = \frac{1}{2}\left(x + \frac{a}{x}\right)$.
		Строим итерационный процесс по формуле
		\[
			x^{n+1} = \frac{1}{2}\left(x^n + \frac{a}{x^n}\right) = g_{II}(x^n).
		\]
		Оценим производную:
		\[
			g'_{II}(x^{n+1}) = \frac{1}{2}\left(1 - \frac{a}{\left(x^{n+1}\right)^2}\right) = 
				\frac{1}{2}\left(1 - \frac{a}{\frac{1}{4}\left(x^n + \frac{a}{x^n}\right)^2}\right) = 
				\frac{1}{2}\left(1 - \frac{a}{\frac{1}{4}\frac{\left(\left(x^n\right)^2 + a\right)^2}{\left(x^n\right)^2}}\right) < 
				\frac{1}{2}. 
		\]
		Значит, в этом случае итерации сходятся.
	\end{trivlist}
\end{example}
\begin{problem}
	На языке программирования $\mathcal{N}$ реализовать метод простых итераций. Критерием
	останова должна служить величина абсолютной и/или относительной ошибки. Программа должна
	рисовать график итераций, т.е. точки $\left(x^k, x^{k+1}\right)$, соединенные прямыми.
	
	Протестировать программу на функциях:
	\begin{enumerate}
		\item $\displaystyle g(x) = x^5 - 3x^3 - 2x^2 + 2 $ ;
		\item $\displaystyle g(x) = \cos{\sin{x}}$;
		\item $\displaystyle g(x) = x^2 - \sin{\left(x+0.15\right)}$;
		\item $\displaystyle g(x) = x^{x - \cos{x}}$;
		\item $\displaystyle g(x) = \left(6 + x\right)^{\frac{1}{2}}$;
		\item $\displaystyle g(x) = 1 + \frac{2}{x}$;
		\item $\displaystyle g(x) = \frac{x^2}{3}$;
		\item $\displaystyle g(x) = -x^2 + 2x + 2$.
	\end{enumerate}
	не менее чем при трех различных начальных приближениях. Проверить (аналитически) условия теоремы сходимости.
\end{problem}
\begin{problem}
	Пусть $\displaystyle g(x) = \frac{x}{2}$. Найти относительную ошибку на $k$-ой итерации. Что произойдет, если
	в качестве критерия останова использовать только малость относительной ошибки?
\end{problem}
\begin{problem}
	Что может произойти, если $g'(P) \approx 0$?
\end{problem}
\begin{problem}
	Переделайте алгоритм, используя в качестве критерия останова условие $\abs{f(x^k)} < \varepsilon$.
	Как изменится работа алгоритма на протестированных задачах?
\end{problem}

\subsection{Метод Ньютона-Рафсона}
Если функция $f(x) \in C^2_{\left[a,b\right]}$, то эту дополнительную информацию о ее поведении можно использовать
для решения уравнения $f(x) = 0$. Методы, использующие информацию и о второй производной, называются методами
второго порядка. Простейший и исторически популярный --- метод Ньютона-Рафсона. Его идея очевидна из следующего чертежа:

Таким образом, новое приближение $x^1$ есть точка пересечения оси абсцисс с касательной к $f(x)$ в точке $x^0$.
Из геометрических соображений 
\[
	f'(x^0) = \frac{0 - f(x^0)}{x^1 - x^0},
\]
откуда получаем формулу для нового приближения
\[
	x^1 = x^0 - \frac{f(x^0)}{f'(x^0)}.
\]
Эту операцию можно повторить и мы получаем в итоге последовательность приближений $\left\{x^k\right\}$.

Опуская подробности доказательства, сразу сформулируем условия, при которых такой итеративный
процесс приводит к решению исходной задачи.
\begin{theorem}(о методе Ньютона-Рафсона)
	Пусть $f(x) \in C^2_{\left[a, b\right]}$ и существует точка 
	$P \in \left[a, b\right] : f(P) = 0$. Если $f'(P) \neq 0$, то найдется
	такое $\delta > 0$, что последовательность $\left\{x^k\right\}$, определенная
	формулой
	\[
		x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)}, \qquad k = 0,1,2, \dots~,
	\]
	сходится к $P$ при любом начальном приближении $x^0 \in \left[P-\delta, P+\delta\right]$.
\end{theorem}
\begin{remark}
	\[
	g(x) = x - \frac{f(x)}{f'(x)} \implies g'(x) = \frac{f(x)f''(x)}{\left(f'(x)\right)^2}.
	\]
	Значит, из $f(P) = 0$ следует, что $g'(P) = 0$. Поэтому найдется такое $\delta > 0$, что
	для всех $x \in \left(P-\delta, P+\delta\right)$ выполняется условие $\abs{g'(x)} < 1$.
	Далее применяем теорему о неподвижной точке. Отсюда видно, что начальное приближение надо
	выбирать из такой $\delta$-окрестности корня, чтобы 
	$\abs{\dfrac{f(x)f''(x)}{\left(f'(x)\right)^2}} < 1$. Это главный недостаток метода, т.к.
	обычно промежуток очень мал и надо иметь очень хорошее начальное приближение.
\end{remark}

\begin{definition}
	Пусть $\left\{x^k\right\}_{k=0}^{\infty} \longrightarrow x^*$.
	Если существуют константы $A \neq 0$ и $R > 0$ такие, что
	\[
	\lim\limits_{k \rightarrow \infty}{\frac{\abs{x^* - x^{k+1}}}{\abs{x^* - x^k}^R}} = A,
	\]
	то говорят, что порядок сходимости $\left\{x^k\right\}$ к $x^*$ равен $R$.
\end{definition}
Если $R = 1$, то сходимость называют линейной, если $R = 2$, то квадратичной. 
\begin{example}
	Проверьте, что сходимость метода Ньютона-Рафсона для уравнения $f(x) = x^3 - 3x + 2 = 0$
	к корню $x^* = -2$ является квадратичной (принимая $x^0 = -2.4$). После этого проверьте, что
	сходимость к другому корню этого же уравнения, $x^* = 1$, является линейной ($x^0 = 1.2$).
	В чем заключается главное отличие этих двух корней?
\end{example}

\begin{theorem}(о сходимости).
	Пусть $\left\{x^k\right\}$ --- последовательность приближений
	метода Ньютона-Рафсона, которая сходится к корню $x^*$ уравнения $f(x) = 0$.
	\begin{enumerate}
		\item Если $x^*$ --- простой корень, то 
			\[
				\abs{x^* - x^{k+1}} \approx 
					\frac{\abs{f''(x^*)}}{2\abs{f'(x^*)}}\abs{x^* - x^k}
			\]
			для достаточно больших $k$.
		\item Если $x^*$ --- корень кратности $s$, то
			\[
				\abs{x^* - x^{k+1}} \approx \frac{s-1}{s}\abs{x^* - x^k}
			\]
			для достаточно больших $k$.
	\end{enumerate}
\end{theorem}

\begin{problem}
	На языке программирования $\mathcal{N}$ реализовать метод Ньютона-Рафсона.
	С его помощью подобрать примеры функций (по 2-е функции), для которых метод
	сходится а) линейно, б) квадратично, в) расходится.
\end{problem}
\begin{problem}
	Сравните метод Ньютона-Рафсона и метод Галлея:
	\[
		x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)}\left[1 - \frac{f(x^k)f''(x^k)}{2(f'(x^k))^2}\right]^{-1}.
	\]
	Какова скорость сходимости метода Галлея?
\end{problem}


\subsection{Метод простой итерации, многомерный случай}
Имеем уравнение $f(x) = 0 $, $x \in \mathbb{R}^n$, которое в координатное форме
записывается как
\[
	f_k(x_1, x_2, \dots, x_n) = 0, \qquad k = 1,2,\dots,n.
\]
Предположим, что систему можно записать в эквивалентном виде
\[
	x = F(x).
\]
Далее, выбрав начальное приближение $x^0$, строим последовательность векторов $\left\{x^j\right\}$:
\[
	x^{j+1} = F(x^j).
\]
Аналогично одномерному случаю, можно показать, что при определенных ограничениях
на $F(x)$ эти итерации сходятся к неподвижной точке отображения $F(x)$, а значит --- к корню
исходного векторного уравнения. В многомерном случае достаточным условием сходимости является,
например, ограниченность нормы $\norm{\dfrac{\partial F_k(x^j)}{\partial x_i}} < 1$. Заметим, что
подбор $F(x)$, удовлетворяющей все условиям, сам по себе --- очень сложная задача. Скорость сходимости,
как и в линейной случае, остается линейным.
\begin{problem}
	Доказать, что простые итерации сходятся линейной.
\end{problem}

Для улучшения сходимости можно использовать ту же идею, на которой основан
метод Зейделя в вести итерации по схеме
\[
	x^{j+1}_{k+1} = F(x_1^{j+1}, x_2^{j+1}, \dots, x_k^{j+1}, x_{k+1}^j, \dots, x_n^j).
\]
Здесь на скорость сходимости влияет и порядок записи уравнений в системе.


\subsection{Метод Ньютона, многомерный случай}
Метод Ньютона-Рафсона легко переносится на многомерный случай. При этом итерации
производятся по формуле:
\[
x^{j+1} = x^j - \left(\frac{\partial f(x^j)}{\partial x}\right)^{-1}f\left(x^j\right).
\]
Условие сходимости $\norm{\dfrac{\partial F}{\partial x}} < 1$ обычно не проверяется, т.к.
вычисление нормы матрицы частных производных требует значительных вычислительных затрат. Разумеется,
проблема с выбором хорошего начального приближения тоже не исчезает.

\begin{remark}
	Обычно вычисления проводятся по более экономной схеме: полагая $\Delta x^j = x^{j+1} - x^j$,
	записывают итерационную формулу в виде системы линейных уравнений:
	\[
		\left(\frac{\partial f(x^j)}{\partial x}\right)\Delta x^j = - f(x^j).
	\]
	Решив эту СЛАУ, находят $\Delta x^j$, а значит, и $x^{j+1}$. При это нет необходимости
	вычислять обратную матрицу частных производных.
\end{remark}

\begin{problem}
	Реализовать на языке программирования $\mathcal{N}$ метод Зейделя для систем нелинейных уравнений.
	Решить с его помощью системы уравнений:
	\[
		\begin{matrix}
			\left\{
				\begin{aligned}
					2x + y - 6 &= 0 \\
					x + 2y &= 0
				\end{aligned}
			\right. & \qquad
			\left\{
				\begin{aligned}
					3x^2 + 2y - 4 &= 0 \\
					2x + 3y - 3 &= 0\\
				\end{aligned}
			\right.
			\\\\
			\left\{
				\begin{aligned}
					2x - 5\cos{y} &= 0 \\
					x\sin{y} &= 0
				\end{aligned}
			\right. & \qquad
			\left\{
				\begin{aligned}
					x^2 + y^2 - z &= 0 \\
					x^2 + y^2 + z^2 - 1 &= 0 \\
					x + y &= 0
				\end{aligned}
			\right.
		\end{matrix}
	\]
	Проверить аналитически условия сходимости.
\end{problem}

\begin{problem}
	Реализовать на языке $\mathcal{N}$ метод Ньютона для систем нелинейных уравнений. 
	Нарисовав с достаточной детализацией графики кривых, локализуйте (т.е. определите 
	примерно их окрестность) корни системы уравнений
	\[
	\left\{
		\begin{aligned}
			7x^3 - 10x - y - 1 &= 0 \\
			8y^3 - 11y + x - 1 &= 0
		\end{aligned}
	\right.
	\]
	Используя метод Ньютона, найти все корни с точностью до 9-го знака после запятой.
\end{problem}

\begin{problem}
	Попробуйте применить метод Ньютона к системе 
	\[
	\left\{
		\begin{aligned}
			x^2 + y^2 - 2 &= 0 \\
			xy - 1 &= 0
		\end{aligned}
	\right.
	\]
	Какие могут возникнуть проблемы?
\end{problem}
\begin{problem}
	Постройте по аналогии с одномерным случаем метод Галлея. Будет ли он эффективней метода Ньютона?
\end{problem}

\end{document}












